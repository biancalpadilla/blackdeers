{{#partial "page"}}
<div class="container">
    <div class="page">

        <main class="page-content" data-cart>
            {{> components/common/breadcrumbs breadcrumbs=breadcrumbs}}

            {{> components/cart/page-title}}

            <div data-cart-status>
                {{> components/cart/status-messages}}
            </div>

            {{#if cart.items.length}}
                <div class="loadingOverlay"></div>

                <div data-cart-content>
                    {{> components/cart/content}}
                </div>

                <div data-cart-totals>
                    <!--<p><span style="text-align:center" id="delivery-date"></span><span style="font-size:11.5px;"> <a href="/shipping-returns/"><em>(exluding samples)</em></a></span></p>-->
                    {{> components/cart/totals}}
                </div>

                {{#if cart.show_primary_checkout_button}}
                    <div class="cart-actions text-right">
                        <a class="btn btn-checkout btn-lg" href="{{urls.checkout.single_address}}" title="{{lang 'cart.checkout.title'}}">{{lang 'cart.checkout.button'}}</a>
                        {{#if cart.show_multiple_address_shipping}}
                            <a class="checkoutMultiple" href="{{urls.checkout.multiple_address}}">
                                {{lang 'cart.preview.checkout_multiple'}}
                            </a>
                        {{/if}}
                    </div>
                {{else}}
                    <div class="cart-actions">
                        <a class="btn btn-alt" href="{{urls.home}}" title="{{lang 'cart.continue_shopping'}}">{{lang 'cart.continue_shopping'}}</a>
                    </div>
                {{/if}}

                {{#if cart.additional_checkout_buttons}}
                    <div class="cart-additionalCheckoutButtons">
                        {{#each cart.additional_checkout_buttons}}
                            {{{this}}}
                        {{/each}}
                    </div>
                {{/if}}
            {{else}}
                <div class="alert alert-warning text-center">{{lang 'cart.checkout.empty_cart'}}</div>
            {{/if}}

            {{{snippet 'cart'}}}
        </main>
    </div>
</div>
{{/partial}}
{{> layout/base}}

<script>
    if (new Date().getHours() < 13) {
        var str = 'Expected Delivery:<br> <b>#{firstDate}</b> - <b>#{secondDate}</b> with <a style="text-decoration: underline;" href="/shipping-returns/">Expedited Shipping</a>';
    } else {
        var str = 'Expected Delivery:<br> <b>#{firstDate}</b> - <b>#{secondDate}</b> with <a style="text-decoration: underline;" href="/shipping-returns/">Expedited Shipping</a>';
    }

    function turnAroundDate(startDate, daysToAdd) {
        var endDate = "", count = 0;
        while (count < daysToAdd){
            // add a day to endDate until "days added" equals "days to add"
            endDate = new Date(startDate.setDate(startDate.getDate() + 1));
            // if endDate is not Sunday or Saturday
            if (endDate.getDay() != 0 && endDate.getDay() != 6) {
                // add a day to "days added"
                count++;
            }
        }
        return endDate;
    }

    function formatDate(date) {
        var dayOfWeek = [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday','Saturday' ][date.getDay()];
        var month = [ "January", "February", "March", "April", "May", "June","July", "August", "September", "October", "November","December" ][date.getMonth()];

        return dayOfWeek + ', ' + month + ' ' + date.getDate();
    }

    function formatString(firstDate, secondDate) {
        return str.replace('#{firstDate}', formatDate(firstDate))
                .replace('#{secondDate}', formatDate(secondDate));
    }

    if (new Date().getDay() != 0 && new Date().getDay() != 6) {
        var time = new Date().getHours() < 13 ? 0 : 1;
        var start = 1 + time
        var end = 2 + time
    } else {
        var start = 2
        var end = 3
    }


    var firstDate = turnAroundDate(new Date(), start);
    var secondDate = turnAroundDate(new Date(), end);

    document.getElementById('delivery-date').innerHTML = formatString(firstDate, secondDate);
</script>
